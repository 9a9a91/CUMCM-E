# CUMCM-E
## 这是一个关于全国大学生数学建模大赛（国赛）2023年E题黄河水沙问题研究的解决代码
## 以下是解题思路和主要使用的方法

## 1. 数据预处理

### 1.1 数据读取
- 采用fillna()函数进行数据预处理
  1. 对“年” “月” “日” 三列进行空缺值填充
- 采用线性插值法进行数据预处理
  1. 对“含沙量”列进行空缺值填充
- 采用Z-score法去除"含沙量(kg/m3) "列的异常值
- 对"含沙量(kg/m3) "列数据进行异常值处理

### 1.2 数据合并
- 导入每一年的数据，并将其合并为一个数据all_data.csv 文件方便后续分析
## 问题一

## 研究该水文站黄河水的含沙量与时间、水位、水流量的关系，并估算近 6 年该水文站的年总水流量和年总排沙量。


### 第一小问：分析时间、水位、水流量与含沙量的相关性

- 通过Spearman相关性分析，进行时间、水位、水流量与含沙量的相关性分析，并且绘制热力图，发现时间、水位、水流量与含沙量的相关性均为 0.55 左右，且时间、水位、水流量与含沙量的相关性均为正相关。
#### 1.1.1 分析该水文站黄河水的含沙量与时间的关系

- 将数据整合成一个列表
- 分别绘制每年的含沙量与时间的关系图
#### 1.1.2 分析流量与含沙量的关系

- 建立双对数函数模型对数据进行拟合
- ln(流量) = a + b * ln(含沙量)
- 计算拟合优度R2
### 第二小问：估算年总水流量和排沙量
- 将每年的水流量求和即为年总水流量
- 计算每年的排沙量
- 计算每年的排沙量 = Σ（水流量 * 含沙量）
## 问题二
### 分析近 6 年该水文站水沙通量的突变性、季节性和周期性等特性，研究水沙通量的变化规律。
#### 2.1.1 通过Mann-Kendall检验进行水沙通量的突变性分析。
- 通过Mann-Kendall检验，对水沙通量进行突变性分析
#### 2.1.2 通过季节性分解进行水沙通量的季节性分析。
- 通过季节性分解，对水沙通量进行季节性分析
#### 2.1.3 通过傅里叶变换进行水沙通量的周期性分析。
- 通过傅里叶变换进行周期性分析
## 问题三
### 根据该水文站水沙通量的变化规律，预测分析该水文站未来两年水沙通量的变化趋势，并为该水文站制订未来两年最优的采样监测方案（采样监测次数和具体时间等），使其既能及时掌握水沙通量的动态变化情况，又能最大程度地减少监测成本资源。
#### 3.1.1 根据水沙通量的变化规律，预测和分析该水文站未来两年水沙通量的变化趋势
- 通过时间序列，构建SARIMA模型进行预测和分析
    1. 对数据进行平稳性检验，检验数据是否平稳
        1. 原假设：数据不平稳，当p值＞=0.05时，不能拒绝原假设。
    2. 进行随机性检验（白噪声检验），检验数据是否为纯随机数据
        1. 通过Ljung-Box Q检验方法进行白噪声检验
        2. 原假设：序列为白噪声（自相关系数为0）
            - 当P值<0.05时，拒绝原假设，序列并非纯随机数据，不是白噪声。
    3. 进行季节性差分
        - 发现仍具有不平稳性
    4. 进行一阶差分
        - 数据通过ADF检验，但为了效果更优，进行二阶差分
    5. 进行二阶差分
        - 数据平稳，通过ADF检验和白噪声检验
    6. 分别绘制季节性和非季节性的ACF和PACF图
        - 分析ACF和PACF图：
            1. AR(p)模型的特征
                - ACF : 呈现拖尾特性，缓慢衰减
                - PACF : 在滞后p阶后截尾（即p阶后的值接近于0或在置信区间内）
            2. MA(q)模型的特征
                - ACF : 在滞后q阶后截尾（即q阶后的值接近于0或在置信区间内）
                - PACF : 呈现拖尾特性，缓慢衰减
            3. ARMA(p,q)模型的特征
                - ACF : 在滞后q阶后呈现AR(p)型的拖尾特性
                - PACF : 在滞后p阶后呈现MA(q)型的拖尾特性
                - 两者都呈现拖尾特性
        - 根据图片进行初步判断p,q,P,Q的阶数
            1. 非季节性ACF基本在滞后1阶后截尾，PACF在2-3阶后截尾，因此初步判断q=1，p=2
        - 为确定更准确的阶数，我们采用AIC（赤池信息准则）和BIC（贝叶斯信息准则）共同确定阶数（通过代码计算实现）
        - 绘制相关热力图（目的是为了直观输出最佳阶数值）
    7. 模型诊断
        - 取得最佳阶数后，进行模型诊断，输出SARIMA(0,2,3)(1,1,2,6)的结果摘要
            （摘要解释放在模型诊断后）
    8. 模型检验
        - 通过dw检验方法进行模型检验：
        1. 0 < DW < 1.5 ：存在正自相关
            - 0 < DW < 1.0 ：强正自相关
            - 1.0 ≤ DW < 1.5 ：弱正自相关
        2. 1.5 ≤ DW ≤ 2.5 ：不存在自相关（残差独立）拟合良好
            - DW = 2 ：完全不存在自相关（理想值）
        3. 2.5 < DW < 4 ：存在负自相关
            - 2.5 < DW ≤ 3.0 ：弱负自相关
            - 3.0 < DW < 4.0 ：强负自相关
        - 如果不存在自相关性就说明模型拟合效果良好

- 根据前两问，发现原时间序列数据存在突变性、周期性、季节性等属性，且排沙量和流量数据变化规律基本一致，因此综合考虑水沙通量为流量。构建模型进行预测分析。
#### 3.1.2 预测该水文站未来两年水沙通量的变化趋势
- 划分训练集和测试集进行预测
## 问题四
### 根据该水文站的水沙通量和河底高程的变化情况，分析每年 6-7 月小浪底水库进行“调水调沙”的实际效果。如果不进行“调水调沙”，10 年以后该水文站的河底高程会如何？
#### 4.1.1 绘制月流量和排沙量变化趋势图
- 通过月流量和排沙量变化趋势，分析调水调沙的实际效果
